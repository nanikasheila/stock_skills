# Portfolio Dashboard

ポートフォリオの資産推移をブラウザ上でインタラクティブに可視化するダッシュボード。

## 概要

- **総資産推移**: 保有銘柄の日次評価額推移（積み上げ面 / 折れ線 / 積み上げ棒）
- **銘柄別評価額**: 現在の保有構成テーブル（評価額・損益・損益率）
- **セクター構成**: ドーナツチャートでセクター別比率を表示
- **月次サマリー**: 月末資産額の推移と前月比変動率
- **銘柄別個別チャート**: 各銘柄の評価額推移を個別に表示（オプション）

## 起動方法

```bash
python3 .claude/skills/portfolio-dashboard/scripts/run_dashboard.py
```

### オプション

| パラメータ | デフォルト | 説明 |
|:---|:---|:---|
| `--port` | 8501 | サーバーポート番号 |
| `--no-browser` | false | ブラウザを自動で開かない |

起動後、`http://localhost:8501` でダッシュボードにアクセス可能。

## サイドバー操作

| 項目 | 機能 |
|:---|:---|
| 表示期間 | 1mo / 3mo / 6mo / 1y / 2y から株価取得期間を選択 |
| チャートスタイル | 積み上げ面 / 折れ線 / 積み上げ棒 から選択 |
| 銘柄別個別チャート | チェックで銘柄ごとのミニチャートを表示 |

## データソース

| データ | ソース | 更新頻度 |
|:---|:---|:---|
| 保有銘柄 | portfolio.csv | 売買記録時 |
| 売買履歴 | data/history/trade/*.json | 売買記録時 |
| 株価 | yfinance（24hキャッシュ） | ページロード時に自動取得 |
| 為替レート | yfinance FXペア | ページロード時に自動取得 |

## 依存

- streamlit >= 1.30.0
- plotly >= 5.18.0
- 既存モジュール: `src/core/portfolio/`, `src/data/yahoo_client.py`, `src/data/history_store.py`

## 技術詳細

### 資産推移の計算方法

1. `data/history/trade/` の売買履歴を時系列で読み込み
2. 各取引日時点での累積保有株数を復元
3. yfinance から各銘柄の日次終値を取得
4. 各日の「保有株数 × 終値 × 為替レート」で円換算評価額を算出
5. Plotly でインタラクティブに可視化
